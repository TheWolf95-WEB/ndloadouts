<!-- ‚öîÔ∏è –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω Battlefield -->
<div id="screen-battlefield-main" class="screen">
  <p class="subtext">
    –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∏—Ä Battlefield.<br><br>
    –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–π –æ—Ä—É–∂–∏–µ, –ø—Ä–æ—Ö–æ–¥–∏ –∏—Å–ø—ã—Ç–∞–Ω–∏—è –∏ —Å–ª–µ–¥–∏ –∑–∞ –Ω–æ–≤—ã–º–∏ –º–µ—Ç–∞-—Å–±–æ—Ä–∫–∞–º–∏.
  </p>

  <div id="bf-user-info" class="user-info-block"></div>
  <h1>Battlefield</h1>

  <div id="bf-role-buttons" class="form-section">

    <!-- üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å -->
    <div id="bf-user-buttons" class="button-grid three-column">
      <div class="card-btn is-visible" id="bf-show-builds-btn">
        <i class="fas fa-eye"></i>
        <span>–í—Å–µ —Å–±–æ—Ä–∫–∏</span>
      </div>

      <div class="card-btn is-visible" id="bf-challenges-btn">
        <i class="fas fa-flag"></i>
        <span>–ò—Å–ø—ã—Ç–∞–Ω–∏—è</span>
      </div>

      <div class="card-btn is-visible" id="bf-settings-btn">
        <i class="fas fa-cog"></i>
        <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã</span>
      </div>
    </div>


    <!-- onclick="event.stopImmediatePropagation(); alert('üöß –†–∞–∑–¥–µ–ª ¬´–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã¬ª —Å–µ–π—á–∞—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.\n\n–ú—ã –∞–∫—Ç–∏–≤–Ω–æ –ø–µ—Ä–µ–≤–æ–¥–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Battlefield –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫ –∏ –≥–æ—Ç–æ–≤–∏–º –ø–µ—Ä–≤—É—é –≤–µ—Ä—Å–∏—é —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –º–µ–Ω—é.\n\nüîú –ü–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è –≤—ã–π–¥–µ—Ç —Å–æ–≤—Å–µ–º —Å–∫–æ—Ä–æ!')"> -->

    <!-- üõ° –ê–¥–º–∏–Ω -->
    <div id="bf-admin-buttons">

      <!-- –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ -->
      <div class="button-grid three-column">
        <div class="card-btn is-visible" id="bf-weapons-db-btn">
          <i class="fas fa-database"></i>
          <span>–ë–∞–∑–∞ –æ—Ä—É–∂–∏–π</span>
        </div>

        <div class="card-btn is-visible" id="bf-challenges-db-btn">
          <i class="fas fa-clipboard-list"></i>
          <span>–ë–∞–∑–∞ –∏—Å–ø—ã—Ç–∞–Ω–∏–π</span>
        </div>

        <div class="card-btn is-visible" id="bf-modules-dict-btn">
          <i class="fas fa-list"></i>
          <span>–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–æ–¥—É–ª–µ–π</span>
        </div>
      </div>

      <!-- –í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ -->
      <div class="button-grid two-column">
        <div class="card-btn is-visible" id="bf-add-build-btn">
          <i class="fas fa-plus"></i>
          <span>–î–æ–±–∞–≤–∏—Ç—å —Å–±–æ—Ä–∫—É</span>
        </div>

        <div class="card-btn is-visible" id="bf-add-challenge-btn">
          <i class="fas fa-trophy"></i>
          <span>–î–æ–±–∞–≤–∏—Ç—å –∏—Å–ø—ã—Ç–∞–Ω–∏–µ</span>
        </div>
      </div>

      <!-- üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
      <div class="global-home-button" style="display:block;">
        <button class="btn" onclick="showScreen('screen-home')">üè† –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ</button>
      </div>
    </div>
  </div>
</div>




<!-- üì¶ –°–ø–∏—Å–æ–∫ —Å–±–æ—Ä–æ–∫ -->
<div id="screen-bf-builds" class="screen" style="display:none;">
  <div class="filters-row">
    <div class="form-section" style="width:50%;">
      <select id="bf-weapon-filter" class="form-input">
        <option value="all">–í—Å–µ —Ç–∏–ø—ã</option>
        <option value="assault">–®—Ç—É—Ä–º–æ–≤—ã–µ</option>
        <option value="smg">–ü–ü</option>
        <option value="sniper">–°–Ω–∞–π–ø–µ—Ä—Å–∫–∏–µ</option>
        <option value="support">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</option>
        <option value="shotgun">–î—Ä–æ–±–æ–≤–∏–∫–∏</option>
      </select>
    </div>
    <div class="form-section" style="width:50%;">
      <select id="bf-category-filter" class="form-input">
        <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
        <option value="popular">–ü–æ–ø—É–ª—è—Ä–Ω–æ–µ</option>
        <option value="new">–ù–æ–≤–∏–Ω–∫–∏</option>
        <option value="topmeta">–¢–æ–ø –º–µ—Ç–∞</option>
        <option value="meta">–ú–µ—Ç–∞</option>
      </select>
    </div>
  </div>

  <div class="search-section">
    <input type="text" id="bf-builds-search" class="form-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é , –º–æ–¥—É–ª—è–º....">
  </div>

  <div class="form-section" style="display:flex;justify-content:space-between;align-items:center;">
    <h2>üì¶ –í—Å–µ —Å–±–æ—Ä–∫–∏</h2>
    <button id="bf-back-from-builds" class="btn btn-back">‚¨Ö –ù–∞–∑–∞–¥</button>
  </div>

  <div id="bf-builds-list">
    <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Å–±–æ—Ä–æ–∫...</p>
  </div>
  <p id="bf-no-results-message" style="display:none;text-align:center;margin-top:20px;">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
</div>


<!-- üõ† –î–æ–±–∞–≤–ª–µ–Ω–∏–µ / –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–±–æ—Ä–∫–∏ -->
<div id="screen-bf-form" class="screen" style="display:none;">
  <div class="form-section">
    <h2>üõ† –î–æ–±–∞–≤–ª–µ–Ω–∏–µ / —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–±–æ—Ä–∫–∏</h2>
  </div>

  <div class="form-section">
    <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Å–±–æ—Ä–∫–∏:</label>
    <input type="text" id="bf-title" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–±–æ—Ä–∫–∏">
  </div>

  <div class="form-section">
    <label>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏:</label>
    <div class="categories-grid">
      <label class="category-checkbox">
        <input type="checkbox" class="bf-build-category" value="popular">
        <span class="checkmark"></span>
        <span>–ü–æ–ø—É–ª—è—Ä–Ω–æ–µ</span>
      </label>
      <label class="category-checkbox">
        <input type="checkbox" class="bf-build-category" value="new">
        <span class="checkmark"></span>
        <span>–ù–æ–≤–∏–Ω–∫–∏</span>
      </label>
      <label class="category-checkbox">
        <input type="checkbox" class="bf-build-category" value="topmeta">
        <span class="checkmark"></span>
        <span>–¢–æ–ø –º–µ—Ç–∞</span>
      </label>
      <label class="category-checkbox">
        <input type="checkbox" class="bf-build-category" value="meta">
        <span class="checkmark"></span>
        <span>–ú–µ—Ç–∞</span>
      </label>
    </div>
  </div>

  <div class="form-section">
    <label>–¢–∏–ø –æ—Ä—É–∂–∏—è:</label>
    <select id="bf-weapon-type" class="form-input"></select>
  </div>

  <div class="form-section">
    <label>–¢–û–ü –º–æ–¥—É–ª–∏:</label>
    <div class="top-modules-grid">
      <input type="text" id="bf-top1" placeholder="ü•á –¢–æ–ø 1" class="form-input top-module-input">
      <input type="text" id="bf-top2" placeholder="ü•à –¢–æ–ø 2" class="form-input top-module-input">
      <input type="text" id="bf-top3" placeholder="ü•â –¢–æ–ø 3" class="form-input top-module-input">
    </div>
  </div>

  <div class="form-section">
    <label>–í–∫–ª–∞–¥–∫–∏ (–º–æ–¥—É–ª–∏):</label>
    <div id="bf-tabs-container"></div>
    <button type="button" id="bf-add-tab" class="btn add-tab-btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É</button>
  </div>

  <div class="form-section">
    <label>–î–∞—Ç–∞:</label>
    <input type="date" id="bf-build-date" class="form-input">
  </div>

  <div class="btn-group">
    <button id="bf-submit-build" class="btn btn-primary">‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–±–æ—Ä–∫—É</button>
    <button id="bf-back-from-form" class="btn btn-back">‚¨Ö –ù–∞–∑–∞–¥</button>
  </div>
</div>


<div id="screen-bf-edit-builds" class="screen" style="display:none;">
  <div class="screen-header">
    <button class="btn btn-back" id="bf-back-from-edit">‚¨Ö –ù–∞–∑–∞–¥</button>
    <h2>‚öôÔ∏è –ë–∞–∑–∞ —Å–±–æ—Ä–æ–∫ Battlefield</h2>
  </div>

  <div class="stats-bar">
    <span id="bf-builds-count">–í—Å–µ–≥–æ: 0 —Å–±–æ—Ä–æ–∫</span>
  </div>

  <!-- –§–∏–ª—å—Ç—Ä—ã -->
  <div class="bf-filters-container" style="padding: 16px; border-bottom: 1px solid #2a3a5a;">
    <div class="bf-filters-row" style="display: flex; gap: 16px; align-items: center; flex-wrap: wrap;">
      <div class="bf-filter-group" style="display: flex; gap: 8px; align-items: center;">
        <strong style="color: #e0e6ee; font-size: 14px;">–í—Å–µ —Ç–∏–ø—ã</strong>
        <select id="bf-edit-type-filter" class="bf-filter-select">
          <option value="all">–í—Å–µ</option>
        </select>
      </div>
            
      <div class="bf-search-group" style="flex: 1; min-width: 200px;">
        <input type="text" id="bf-edit-search" class="bf-search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é...">
      </div>
    </div>
  </div>

  <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ - 2 –≤ —Ä—è–¥ -->
  <div id="bf-edit-builds-grid" class="bf-builds-grid">
    <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Å–±–æ—Ä–æ–∫...</p>
  </div>
</div>


<!-- üìö –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–æ–¥—É–ª–µ–π ‚Äî –≤—ã–±–æ—Ä —Ç–∏–ø–∞ -->
<div id="screen-bf-modules-types" class="screen" style="display:none;">
  <h2>–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–æ–¥—É–ª–µ–π ‚Äî —Ç–∏–ø –æ—Ä—É–∂–∏—è</h2>
  <div id="bf-modules-types-grid" class="button-grid"></div>
  <button class="btn" id="bf-back-from-mod-types">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>


<!-- üìã –°–ø–∏—Å–æ–∫ –º–æ–¥—É–ª–µ–π –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ -->
<div id="screen-bf-modules-list" class="screen" style="display:none;">
  <button class="btn" id="bf-back-from-mod-list">‚¨Ö –ù–∞–∑–∞–¥</button>
  <h2 id="bf-modules-title">–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º–æ–¥—É–ª–µ–π</h2>

  <div id="bf-modules-toolbar" class="flex" style="gap:8px;margin-bottom:10px;flex-wrap:wrap;">
    <select id="bf-mod-category-select" class="form-input" style="min-width:180px;">
      <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é...</option>
    </select>
    
    <input id="bf-mod-category" class="form-input" placeholder="–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é">
    <input id="bf-mod-en" class="form-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ EN (–Ω–∞–ø—Ä–∏–º–µ—Ä: Compensator)">
    <button class="btn" id="bf-mod-add-btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
  </div>


  <div id="bf-modules-list"></div>
</div>


<!-- üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —ç–∫—Ä–∞–Ω –∏—Å–ø—ã—Ç–∞–Ω–∏–π -->
<div id="screen-bf-challenges" class="screen" style="display:none;">
  <div class="screen-header">
    <h2>‚öîÔ∏è Battlefield | –ò—Å–ø—ã—Ç–∞–Ω–∏—è</h2>
    <p class="screen-subtitle">–í—ã–ø–æ–ª–Ω—è–π –∏—Å–ø—ã—Ç–∞–Ω–∏—è –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π –ø—Ä–æ–≥—Ä–µ—Å—Å</p>
  </div>

  <!-- üîç –ü–æ–∏—Å–∫ –∏ –≤–∫–ª–∞–¥–∫–∏ -->
  <div class="search-box">
    <input type="text" id="bf-search-user" placeholder="üîç –ü–æ–∏—Å–∫" class="search-input">
  </div>

  <div id="bf-tabs" class="tabs-grid"></div>

  <div class="status-tabs">
    <button class="status-btn" data-status="active">–ê–∫—Ç–∏–≤–Ω—ã–µ</button>
    <button class="status-btn" data-status="completed">–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ</button>
  </div>


  <!-- üß© –°–ø–∏—Å–æ–∫ –∏—Å–ø—ã—Ç–∞–Ω–∏–π -->
  <div id="bf-challenges-list" class="challenges-grid">
    <div class="loading-spinner">–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å–ø—ã—Ç–∞–Ω–∏–π...</div>
  </div>

    <button class="btn" id="bf-back-from-challenges">‚¨Ö –ù–∞–∑–∞–¥</button>
</div>


<!-- üõ° –≠–∫—Ä–∞–Ω –±–∞–∑—ã –∏—Å–ø—ã—Ç–∞–Ω–∏–π (–¥–ª—è –∞–¥–º–∏–Ω–∞) -->
<div id="screen-bf-challenges-db" class="screen" style="display:none;">
  <div class="screen-header">
    <h2>üß© –ë–∞–∑–∞ –∏—Å–ø—ã—Ç–∞–Ω–∏–π Battlefield</h2>
    <p class="screen-subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º–∏ –∏—Å–ø—ã—Ç–∞–Ω–∏—è–º–∏ —Å–∏—Å—Ç–µ–º—ã</p>
  </div>

  <div class="btn-group" style="margin-bottom:20px;">
    <button class="btn btn-secondary" id="bf-back-to-bfmain">‚¨Ö –ù–∞–∑–∞–¥</button>
  </div>

  <div class="stats-bar">
    <div class="stat-item">
      <span class="stat-value" id="bf-total-challenges">0</span>
      <span class="stat-label">–í—Å–µ–≥–æ –∏—Å–ø—ã—Ç–∞–Ω–∏–π</span>
    </div>
    <div class="stat-item">
      <span class="stat-value" id="bf-total-categories">0</span>
      <span class="stat-label">–ö–∞—Ç–µ–≥–æ—Ä–∏–π</span>
    </div>
  </div>

  <div class="search-box">
    <input type="text" id="bf-search-challenges" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é..." class="search-input">
    <select id="bf-filter-category" class="filter-select">
      <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
    </select>
  </div>

  <div id="bf-challenges-grid" class="challenges-grid">
    <div class="loading-spinner">–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å–ø—ã—Ç–∞–Ω–∏–π...</div>
  </div>
</div>

<!-- üß± –≠–∫—Ä–∞–Ω –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø—ã—Ç–∞–Ω–∏—è -->
<div id="screen-bf-add-challenge" class="screen" style="display:none;">
  <div class="screen-header">
    <h2>üõ† –î–æ–±–∞–≤–∏—Ç—å –∏—Å–ø—ã—Ç–∞–Ω–∏–µ</h2>
  </div>

<div class="form-section">
  <label for="bf-category-select">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
  <select id="bf-category-select" class="form-input">
    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é...</option>
  </select>

  <div class="category-actions">
  <button class="btn-mini" id="bf-edit-category-btn" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é">
    <i class="fas fa-edit"></i>
  </button>
  <button class="btn-mini" id="bf-delete-category-btn" title="–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é">
    <i class="fas fa-trash"></i>
  </button>
</div>


  <div class="add-category-inline">
    <input type="text" id="bf-new-category" class="form-input" placeholder="–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è">
    <button class="btn btn-secondary" id="bf-add-category-btn">‚ûï –î–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É</button>
  </div>
</div>


  <div class="form-section">
    <label for="bf-title-en">–ù–∞–∑–≤–∞–Ω–∏–µ (EN)</label>
    <input type="text" id="bf-title-en" class="form-input" placeholder="Get 30 kills">
  </div>

  <div class="form-section">
    <label for="bf-title-ru">–ù–∞–∑–≤–∞–Ω–∏–µ (RU)</label>
    <input type="text" id="bf-title-ru" class="form-input" placeholder="–°–¥–µ–ª–∞–π—Ç–µ 30 —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–π">
  </div>

  <div class="form-section flex-row">
    <div class="form-col">
      <label for="bf-goal">–¶–µ–ª—å</label>
      <input type="number" id="bf-goal" class="form-input" value="0">
    </div>
  </div>

  <div class="btn-group">
    <button class="btn btn-primary" id="bf-submit-challenge">‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    <button class="btn btn-back" id="bf-back-from-add">‚¨Ö –ù–∞–∑–∞–¥</button>
  </div>
</div>





<!-- –ù–ê–°–¢–†–û–ô–ö–ò –ò–ì–†–´  -->


<!-- üéõ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —ç–∫—Ä–∞–Ω –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
<div id="screen-bf-settings" class="screen" style="display:none;">

<!-- ‚öôÔ∏è –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å Battlefield -->
<div class="screen-header settings-header clean-style">
  <div class="settings-top">
    <button class="btn btn-back" id="bf-settings-back">‚¨Ö –ù–∞–∑–∞–¥</button>
  </div>

  <div class="settings-head">
    <div class="head-left">
      <h2 class="settings-title">BATTLEFIELD –ù–ê–°–¢–†–û–ô–ö–ò</h2>
      <p class="settings-subtitle">–ü–µ—Ä–µ–≤–æ–¥ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –Ω–∞ —Ä—É—Å—Å–∫–∏–π –µ—â—ë –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ. <br><br> –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—Ä–∞–∑—ã –º–æ–≥—É—Ç –∑–≤—É—á–∞—Ç—å —Å—Ç—Ä–∞–Ω–Ω–æ ‚Äî –º—ã –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–æ–≤–æ–¥–∏–º –ø–µ—Ä–µ–≤–æ–¥ –¥–æ –∏–¥–µ–∞–ª–∞.</p>
    </div>
  </div>

  <div class="settings-category-bar clean">
    <button class="btn btn-burger" id="bf-settings-burger" title="–û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏">
      <i class="fas fa-bars"></i>
    </button>
    <h3 id="bf-settings-current-title" class="settings-category-title">
      <span class="cat-en">Accessibility</span>
      <span class="cat-ru">–û—Å–Ω–æ–≤–Ω—ã–µ</span>
    </h3>
  </div>
</div>


  <!-- –í—ã–µ–∑–∂–∞—é—â–µ–µ –º–µ–Ω—é –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
  <aside id="bf-settings-drawer" aria-hidden="true">
    <h3 style="margin:8px 8px 12px;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã</h3>
    <nav id="bf-settings-categories" style="display:flex;flex-direction:column;gap:8px;"></nav>
  </aside>

  <div id="bf-settings-overlay"
       style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:10;"></div>

  <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
  <div id="bf-settings-content" style="margin-top:12px;">
    <div class="loading-spinner">–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫...</div>
  </div>


<div id="bf-subsettings-overlay">
  <div class="subsettings-container">
    <div class="subsettings-header">
      <div>
        <h2 id="bf-subsettings-title-en"></h2>
        <p id="bf-subsettings-title-ru"></p>
      </div>
      <button id="bf-close-subsettings">‚úñ</button>
    </div>
    <div id="bf-subsettings-list"></div>
  </div>
</div>


</div>



  <script src="/static/bf.js?v={{ version }}"></script>


<script>
/* ===============================
   BF SETTINGS ‚Äî VIEW ONLY
   =============================== */

(function() {
  // ‚Äî‚Äî‚Äî –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
  const BF_SETTINGS_CATEGORIES = [
    { key: 'accessibility', en: 'Accessibility',    ru: '–û—Å–Ω–æ–≤–Ω—ã–µ' },
    { key: 'gameplay',      en: 'Gameplay',         ru: '–ò–≥—Ä–æ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å' },
    { key: 'campaign',      en: 'Campaign',         ru: '–ö–∞–º–ø–∞–Ω–∏—è' },
    { key: 'controller',    en: 'Controller',       ru: '–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä' },
    { key: 'mousekeyboard', en: 'Mouse & Keyboard', ru: '–ú—ã—à—å –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞' },
    { key: 'graphics',      en: 'Graphics',         ru: '–ì—Ä–∞—Ñ–∏–∫–∞' },
    { key: 'audio',         en: 'Audio',            ru: '–ó–≤—É–∫' },
    { key: 'system',        en: 'System',           ru: '–°–∏—Å—Ç–µ–º–∞' },
  ];

  // ‚Äî‚Äî‚Äî –≠–ª–µ–º–µ–Ω—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
  const scrView = document.getElementById('screen-bf-settings');
  const btnViewBack = document.getElementById('bf-settings-back');
  const btnBurger = document.getElementById('bf-settings-burger');
  const drawer = document.getElementById('bf-settings-drawer');
  const overlay = document.getElementById('bf-settings-overlay');
  const catsNav = document.getElementById('bf-settings-categories');
  const content = document.getElementById('bf-settings-content');
  const currentTitle = document.getElementById('bf-settings-current-title');


  // === –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –æ–≤–µ—Ä–ª–µ—è ===
  const subOverlay = document.getElementById('bf-subsettings-overlay');
  const subOverlayTitleEn = document.getElementById('bf-subsettings-title-en');
  const subOverlayTitleRu = document.getElementById('bf-subsettings-title-ru');
  const subOverlayList = document.getElementById('bf-subsettings-list');
  const subOverlayClose = document.getElementById('bf-close-subsettings');

  // ‚Äî‚Äî‚Äî –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
  const btnOpenUser = document.getElementById('bf-settings-btn');

  // ‚Äî‚Äî‚Äî –°–æ—Å—Ç–æ—è–Ω–∏–µ
  let currentCategoryKey = 'accessibility';
  let currentSubSettings = [];

  // ‚Äî‚Äî‚Äî API
  async function apiGetSettings(categoryKey = '') {
    const url = categoryKey
      ? `/api/bf/settings?category=${encodeURIComponent(categoryKey)}`
      : '/api/bf/settings';
    const r = await fetch(url);
    if (!r.ok) throw new Error('Failed to load settings');
    return r.json();
  }

  // ‚Äî‚Äî‚Äî –£—Ç–∏–ª–∏—Ç—ã
  function categoryByKey(key) {
    return BF_SETTINGS_CATEGORIES.find(c => c.key === key) || BF_SETTINGS_CATEGORIES[0];
  }

  function openDrawer() {
    drawer.style.left = '0';
    overlay.style.display = 'block';
    drawer.setAttribute('aria-hidden', 'false');
  }

  function closeDrawer() {
    drawer.style.left = '-320px';
    overlay.style.display = 'none';
    drawer.setAttribute('aria-hidden', 'true');
  }

  // ‚Äî‚Äî‚Äî –†–µ–Ω–¥–µ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ –±—É—Ä–≥–µ—Ä-–º–µ–Ω—é
  function renderCategoriesNav() {
    catsNav.innerHTML = '';
    BF_SETTINGS_CATEGORIES.forEach(cat => {
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'btn';
      btn.style.textAlign = 'left';
      btn.textContent = `${cat.en} ‚Äî ${cat.ru}`;
      btn.dataset.key = cat.key;
      btn.onclick = () => {
        document.querySelectorAll('#bf-settings-categories button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentCategoryKey = cat.key;
        currentTitle.innerHTML = `${cat.en} <span class="cat-ru">${cat.ru}</span>`;
        closeDrawer();
        renderUserSettings();
      };
      catsNav.appendChild(btn);
    });
  }

  // ‚Äî‚Äî‚Äî –†–µ–Ω–¥–µ—Ä —Å—Ç—Ä–æ–∫–∏ –æ–¥–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
  function renderUserSettingRow(item) {
    const wrap = document.createElement('div');
    wrap.className = 'setting-row';

    const info = document.createElement('div');
    info.className = 'setting-info';
    info.innerHTML = `
      <div class="title-en">${item.title_en || ''}</div>
      <div class="title-ru">${item.title_ru || ''}</div>
    `;

    const control = document.createElement('div');
    control.className = 'setting-control';

    switch (item.type) {
      case 'toggle': {
        const toggle = document.createElement('div');
        toggle.className = 'bf-toggle';
      
        // —Å–æ–∑–¥–∞—ë–º –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ç—É–º–±–ª–µ—Ä –±–µ–∑ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
        toggle.innerHTML = `
          <div class="bf-toggle-track">
            <div class="bf-toggle-knob"></div>
          </div>
          <div class="bf-toggle-labels">
            <span class="on-label">ON / –í–ö–õ</span>
            <span class="off-label">OFF / –í–´–ö–õ</span>
          </div>
        `;
      
        // –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        const isOn = item.default === 'true' || item.default === true;
        if (isOn) toggle.classList.add('on');
        control.appendChild(toggle);
        break;
      }
      case 'slider': {
        const valLabel = document.createElement('span');
        valLabel.textContent = item.default || '0';
        const rng = document.createElement('input');
        rng.type = 'range';
        rng.disabled = true;
        rng.value = item.default || 0;
        control.appendChild(valLabel);
        control.appendChild(rng);
        break;
      }
      case 'number': {
        const num = document.createElement('input');
        num.type = 'number';
        num.disabled = true;
        num.value = item.default ?? '';
        control.appendChild(num);
        break;
      }
      case 'select': {
        const selectWrap = document.createElement('div');
        selectWrap.className = 'bf-select-wrap';
      
        const sel = document.createElement('select');
        sel.className = 'bf-select';
      
        // üó£Ô∏è –°–ª–æ–≤–∞—Ä—å –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –¥–ª—è Battlefield Settings (EN ‚Üí RU)
        const translationMap = {
          // –†–∞–∑–º–µ—Ä—ã –∏ –º–∞—Å—à—Ç–∞–±—ã
          "Tiny": "–ö—Ä–æ—à–µ—á–Ω—ã–π",
          "Small": "–ú–∞–ª–µ–Ω—å–∫–∏–π",
          "Medium": "–°—Ä–µ–¥–Ω–∏–π",
          "Normal": "–û–±—ã—á–Ω—ã–π",
          "Large": "–ë–æ–ª—å—à–æ–π",
          "Huge": "–û–≥—Ä–æ–º–Ω—ã–π",
          "Default": "–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é",
          "Custom": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π",
          "Auto": "–ê–≤—Ç–æ",
        
          // –ö–æ–Ω—Ç—Ä–∞—Å—Ç, —è—Ä–∫–æ—Å—Ç—å, –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —Ä–µ–∂–∏–º—ã
          "High Contrast": "–í—ã—Å–æ–∫–∏–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç",
          "Low Contrast": "–ù–∏–∑–∫–∏–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç",
          "Brightness": "–Ø—Ä–∫–æ—Å—Ç—å",
          "Contrast": "–ö–æ–Ω—Ç—Ä–∞—Å—Ç",
          "Colorblind Mode": "–†–µ–∂–∏–º –¥–∞–ª—å—Ç–æ–Ω–∏–∫–∞",
          "Tritanopia": "–¢—Ä–∏—Ç–∞–Ω–æ–ø–∏—è",
          "Deuteranopia": "–î–µ–π—Ç–µ—Ä–∞–Ω–æ–ø–∏—è",
          "Protanopia": "–ü—Ä–æ—Ç–∞–Ω–æ–ø–∏—è",
          "Off": "–í—ã–∫–ª",
          "On": "–í–∫–ª",
          "Enabled": "–í–∫–ª—é—á–µ–Ω–æ",
          "Disabled": "–í—ã–∫–ª—é—á–µ–Ω–æ",
        
          // –†–µ–∂–∏–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
          "Hold": "–£–¥–µ—Ä–∂–∏–≤–∞—Ç—å",
          "Toggle": "–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç—å",
          "Press": "–ù–∞–∂–∞—Ç–∏–µ",
          "Double Tap": "–î–≤–æ–π–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ",
          "Click": "–ö–ª–∏–∫",
          "Release": "–û—Ç–ø—É—Å—Ç–∏—Ç—å",
        
          // –ó–≤—É–∫ –∏ –≥–æ–ª–æ—Å
          "Voice Chat": "–ì–æ–ª–æ—Å–æ–≤–æ–π —á–∞—Ç",
          "Push to Talk": "–ù–∞–∂–∞—Ç—å –¥–ª—è —Ä–∞–∑–≥–æ–≤–æ—Ä–∞",
          "Always On": "–í—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–µ–Ω–æ",
          "Mute": "–ë–µ–∑ –∑–≤—É–∫–∞",
          "Unmute": "–°–æ –∑–≤—É–∫–æ–º",
          "Headphones": "–ù–∞—É—à–Ω–∏–∫–∏",
          "Speakers": "–ö–æ–ª–æ–Ω–∫–∏",
        
          // –ì—Ä–∞—Ñ–∏–∫–∞
          "Ultra": "–£–ª—å—Ç—Ä–∞",
          "High": "–í—ã—Å–æ–∫–∏–π",
          "Medium": "–°—Ä–µ–¥–Ω–∏–π",
          "Low": "–ù–∏–∑–∫–∏–π",
          "Very Low": "–û—á–µ–Ω—å –Ω–∏–∑–∫–∏–π",
          "Resolution": "–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ",
          "Fullscreen": "–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º",
          "Borderless": "–ë–µ–∑ —Ä–∞–º–∫–∏",
          "Windowed": "–û–∫–æ–Ω–Ω—ã–π",
        
          // –ì–µ–π–º–ø–ª–µ–π
          "Instant": "–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ",
          "Partial": "–ß–∞—Å—Ç–∏—á–Ω–æ",
          "All": "–í—Å–µ",
          "Squad": "–û—Ç—Ä—è–¥",
          "Team": "–ö–æ–º–∞–Ω–¥–∞",
          "Solo": "–û–¥–∏–Ω",
          "Prioritize Interact": "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ",
          "Prioritize Reload": "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞",
          "Stand": "–°—Ç–æ—è—Ç—å",
          "Crouch": "–ü—Ä–∏—Å–µ—Å—Ç—å",
          "Prone": "–õ–µ—á—å",
          "Sprint": "–ë–µ–≥",
          "Aim": "–ü—Ä–∏—Ü–µ–ª–∏–≤–∞–Ω–∏–µ",
          "Fire": "–°—Ç—Ä–µ–ª—å–±–∞",
        
          // –ö–∞–º–µ—Ä–∞ –∏ –≤–≤–æ–¥
          "Mouse": "–ú—ã—à—å",
          "Keyboard": "–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞",
          "Controller": "–ì–µ–π–º–ø–∞–¥",
          "Sensitivity": "–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å",
          "Invert Y-Axis": "–ò–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Å—å Y",
          "Horizontal": "–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ",
          "Vertical": "–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ",
        
          // –ü—Ä–æ—á–µ–µ
          "Reset": "–°–±—Ä–æ—Å–∏—Ç—å",
          "Apply": "–ü—Ä–∏–º–µ–Ω–∏—Ç—å",
          "Save": "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å",
          "Back": "–ù–∞–∑–∞–¥",
          "Yes": "–î–∞",
          "No": "–ù–µ—Ç"
        };

      

          (item.options || []).forEach(opt => {
            const o = document.createElement('option');
            const ru = translationMap[opt] || opt;
            o.textContent = `${opt} / ${ru}`;
            if (opt === item.default) o.selected = true;
            sel.appendChild(o);
          });
        
          sel.addEventListener('change', () => {
            console.log(`Selected option for ${item.title_en}:`, sel.value);
          });
        
          const ruLabel = document.createElement('span');
          ruLabel.className = 'bf-select-ru';
          ruLabel.textContent = item.title_ru || '';
        
          selectWrap.append(sel, ruLabel);
          control.appendChild(selectWrap);
          break;
        }
        



        // üü¶ –≤–æ—Ç —Å—é–¥–∞ –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤—ã–π case
        case 'button': {
          const btn = document.createElement('button');
          btn.className = 'edit-btn';
        
          const title = (item.title_en || '').toLowerCase();
          const isReset = title.includes('reset');
        
            // –¥–≤—É—è–∑—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏
            btn.innerHTML = isReset
              ? 'RESET <span class="btn-ru">–°–ë–†–û–°–ò–¢–¨</span>'
              : 'EDIT <span class="btn-ru">–†–ï–î–ê–ö–¢</span>';
        
          // –µ—Å–ª–∏ —ç—Ç–æ reset ‚Äî –¥–µ–ª–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π
          if (isReset) {
            btn.disabled = true;
            btn.style.opacity = '0.6';
            btn.style.cursor = 'default';
          } else {
            // –∏–Ω–∞—á–µ –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ–π
            btn.onclick = () => {
              if (Array.isArray(item.subsettings) && item.subsettings.length) {
                openSubsettings(item.title_en, item.title_ru, item.subsettings);
              } else {
                alert('–í–ª–æ–∂–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–µ—Ç');
              }
            };
          }
        
          control.appendChild(btn);
          break;
        }





        case 'color': {
          const colorWrap = document.createElement('div');
          colorWrap.style.display = 'flex';
          colorWrap.style.alignItems = 'center';
          colorWrap.style.gap = '10px';
        
          const colorBox = document.createElement('div');
          colorBox.className = 'color-preview';
          colorBox.style.backgroundColor = item.default || '#000';
          colorBox.title = item.default;
          colorBox.style.width = '28px';
          colorBox.style.height = '28px';
          colorBox.style.borderRadius = '4px';
          colorBox.style.border = '1px solid rgba(255,255,255,0.3)';
        
          const colorLabel = document.createElement('span');
          colorLabel.textContent = item.default?.toUpperCase() || '#000000';
          colorLabel.style.color = '#aaa';
          colorLabel.style.fontSize = '13px';
          colorLabel.style.letterSpacing = '0.5px';
        
          colorWrap.append(colorBox, colorLabel);
          control.append(colorWrap);
          break;
        }

        
      default:
        control.textContent = item.default ?? '';
    }

    wrap.appendChild(info);
    wrap.appendChild(control);
    return wrap;
  }

  // ‚Äî‚Äî‚Äî –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –≤—ã–≤–æ–¥ –Ω–∞—Å—Ç—Ä–æ–µ–∫
  async function renderUserSettings() {
    content.innerHTML = '<div class="loading-spinner">–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫...</div>';

    try {
      const data = await apiGetSettings(currentCategoryKey);
      content.innerHTML = '';

      if (!data || !data.length) {
        const p = document.createElement('p');
        p.style.opacity = '.7';
        p.textContent = '–ü–æ–∫–∞ –Ω–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.';
        content.appendChild(p);
        return;
      }

      let currentSection = '';

      data.forEach(item => {
        if (item.section && item.section !== currentSection) {
          currentSection = item.section;
          const sec = document.createElement('div');
          sec.className = 'bf-section-title';
          const [en, ru] = item.section.split(" ‚Äî ");
          sec.innerHTML = `
            <div class="section-header">
              <span class="section-en">${en || ''}</span>
              ${ru ? `<span class="section-ru">‚Äî ${ru}</span>` : ''}
            </div>
          `;
          content.appendChild(sec);
        }

        content.appendChild(renderUserSettingRow(item));
      });
    } catch (e) {
      content.innerHTML = '<p style="color:#f55">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫</p>';
      console.error(e);
    }
  }


  // === –§—É–Ω–∫—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∞ –æ–¥–Ω–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ===
    function renderSubSetting(item) {
      const wrap = document.createElement('div');
      wrap.className = 'setting-row';
    
      const info = document.createElement('div');
      info.className = 'setting-info';
      info.innerHTML = `
        <div class="title-en">${item.title_en}</div>
        <div class="title-ru">${item.title_ru || ''}</div>
      `;
    
      const control = document.createElement('div');
      control.className = 'setting-control';
    
      switch (item.type) {
        case 'toggle': {
          const toggle = document.createElement('div');
          toggle.className = 'bf-toggle';
        
          // —Å–æ–∑–¥–∞—ë–º –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ç—É–º–±–ª–µ—Ä –±–µ–∑ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
          toggle.innerHTML = `
            <div class="bf-toggle-track">
              <div class="bf-toggle-knob"></div>
            </div>
            <div class="bf-toggle-labels">
              <span class="on-label">ON / –í–ö–õ</span>
              <span class="off-label">OFF / –í–´–ö–õ</span>
            </div>
          `;
        
          // –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
          const isOn = item.default === 'true' || item.default === true;
          if (isOn) toggle.classList.add('on');
          control.appendChild(toggle);
          break;
        }
        case 'slider': {
          const val = document.createElement('span');
          val.textContent = item.default || '0';
          const rng = document.createElement('input');
          rng.type = 'range';
          rng.disabled = true;
          rng.value = item.default || 0;
          control.appendChild(val);
          control.appendChild(rng);
          break;
        }
        case 'select': {
          const sel = document.createElement('select');
          (item.options || []).forEach(opt => {
            const o = document.createElement('option');
            o.textContent = opt;
            if (opt === item.default) o.selected = true;
            sel.appendChild(o);
          });
          control.appendChild(sel);
          break;
        }

        case 'color': {
          const colorWrap = document.createElement('div');
          colorWrap.style.display = 'flex';
          colorWrap.style.alignItems = 'center';
          colorWrap.style.gap = '10px';
        
          const colorBox = document.createElement('div');
          colorBox.className = 'color-preview';
          colorBox.style.backgroundColor = item.default || '#000';
          colorBox.title = item.default;
          colorBox.style.width = '28px';
          colorBox.style.height = '28px';
          colorBox.style.borderRadius = '4px';
          colorBox.style.border = '1px solid rgba(255,255,255,0.3)';
        
          const colorLabel = document.createElement('span');
          colorLabel.textContent = item.default?.toUpperCase() || '#000000';
          colorLabel.style.color = '#aaa';
          colorLabel.style.fontSize = '13px';
          colorLabel.style.letterSpacing = '0.5px';
        
          colorWrap.append(colorBox, colorLabel);
          control.append(colorWrap);
          break;
        }



          
        default:
          control.textContent = item.default ?? '';
      }
    
      wrap.appendChild(info);
      wrap.appendChild(control);
      return wrap;
    }
    
    // === –†–µ–Ω–¥–µ—Ä —Å–ø–∏—Å–∫–∞ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ ===
    function renderSubsettings(subsettings) {
      subOverlayList.innerHTML = '';
      subsettings.forEach(sub => {
        subOverlayList.appendChild(renderSubSetting(sub));
      });
    }
    
    // === –û—Ç–∫—Ä—ã—Ç–∏–µ –æ–≤–µ—Ä–ª–µ—è ===
    function openSubsettings(title_en, title_ru, subsettings) {
      currentSubSettings = subsettings;
      subOverlayTitleEn.textContent = title_en;
      subOverlayTitleRu.textContent = title_ru;
      renderSubsettings(subsettings);
    
      // –ø–ª–∞–≤–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ
      subOverlay.classList.add('active');
    }

    
    // === –ó–∞–∫—Ä—ã—Ç–∏–µ –æ–≤–µ—Ä–ª–µ—è ===
    subOverlayClose.addEventListener('click', () => {
      subOverlay.classList.remove('active');
    });

  // ‚Äî‚Äî‚Äî –ù–∞–≤–∏–≥–∞—Ü–∏—è
  btnViewBack?.addEventListener('click', () => {
    if (typeof showScreen === 'function') showScreen('screen-battlefield-main');
  });

  btnBurger?.addEventListener('click', openDrawer);
  overlay?.addEventListener('click', closeDrawer);

  // ‚Äî‚Äî‚Äî –û—Ç–∫—Ä—ã—Ç–∏–µ —ç–∫—Ä–∞–Ω–∞ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
  btnOpenUser?.addEventListener('click', () => {
    renderCategoriesNav();
    const cat = categoryByKey(currentCategoryKey);
    currentTitle.innerHTML = `${cat.en} <span class="cat-ru">${cat.ru}</span>`;
    renderUserSettings();
    if (typeof showScreen === 'function') showScreen('screen-bf-settings');
  });


    // --- –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ª–∏–ø–∞–Ω–∏–µ overlay, —á—Ç–æ–±—ã —Å–µ–ª–µ–∫—Ç—ã –±—ã–ª–∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã
  const observer = new MutationObserver(() => {
    if (overlay.style.display === 'none') {
      overlay.style.pointerEvents = 'none';
    } else {
      overlay.style.pointerEvents = 'auto';
    }
  });
  observer.observe(overlay, { attributes: true, attributeFilter: ['style'] });
  

})();
</script>
